# üö® Incidente de Seguridad: Cryptominer via CVE-2025-55182

**Fecha:** 2025-12-14  
**Severidad:** Cr√≠tica  
**Estado:** ‚úÖ Resuelto  
**CVE:** CVE-2025-55182 (React2Shell)

---

## üìã Resumen Ejecutivo

El servidor Cane fue comprometido por un cryptominer que explot√≥ la vulnerabilidad CVE-2025-55182 en Next.js/React. El atacante logr√≥ ejecutar c√≥digo malicioso dentro del container `3t-app`, consumiendo 2.4GB RAM y 357% CPU. El incidente fue detectado, contenido y resuelto en la misma sesi√≥n.

---

## üïê Cronolog√≠a

| Hora (CLT) | Evento |
|------------|--------|
| ~11:27 UTC (12 Dic) | Proceso malicioso iniciado |
| 15:30 (14 Dic) | Detecci√≥n durante an√°lisis de recursos |
| 15:35 | Identificaci√≥n del proceso `XXBCKoIh` |
| 15:40 | Confirmaci√≥n de cryptominer + conexi√≥n C2 |
| 15:42 | Container detenido y eliminado |
| 16:00 | Repo independiente creado (CarloCorleone/3T) |
| 16:10 | Dependencias actualizadas (Next.js 16.0.10, React 19.2.3) |
| 16:15 | Test local exitoso |
| 19:10 | Deploy en producci√≥n completado |
| 19:13 | Verificaci√≥n de recursos - servidor normalizado |

---

## üîç An√°lisis del Ataque

### Vector de Entrada
- **CVE:** CVE-2025-55182 / GHSA-9qr9-h5gf-34mp
- **Nombre:** "React2Shell"
- **Tipo:** Remote Code Execution (RCE)
- **Vector:** React Server Components Flight Protocol
- **CVSS:** 9.8 (Cr√≠tica)

### Versiones Vulnerables
- Next.js: 15.5.4 ‚ùå
- React: 19.1.0 ‚ùå

### Proceso Malicioso Detectado
```
Nombre:     XXBCKoIh
PID:        397822
Ubicaci√≥n:  /tmp/XXBCKoIh (deleted)
RAM:        2.4 GB (2,406,628 kB)
CPU:        357%
Threads:    10
Usuario:    nextjs (UID 1001)
Empaquetado: UPX (ofuscado)
```

### Conexi√≥n C2 (Command & Control)
```
IP:         85.239.243.201
Puerto:     19999
Proveedor:  Contabo GmbH (Alemania)
Estado:     ESTABLISHED
```

---

## ‚úÖ Acciones de Remediaci√≥n

### 1. Contenci√≥n Inmediata
```bash
docker stop 3t-app && docker rm 3t-app
```

### 2. Separaci√≥n de Repositorio
- Creado repo independiente: `CarloCorleone/3T`
- Eliminados archivos con secrets (workflows con API keys)

### 3. Actualizaci√≥n de Dependencias
```json
// Antes (vulnerable)
"next": "15.5.4",
"react": "19.1.0"

// Despu√©s (parcheado)  
"next": "16.0.10",
"react": "19.2.3"
```

### 4. Migraci√≥n a pnpm
- Dockerfile actualizado para usar pnpm
- Build m√°s r√°pido y seguro

### 5. Deploy Limpio
```bash
/opt/cane/3t-new/
docker compose build --no-cache
docker compose up -d
```

---

## üìä Impacto y Recuperaci√≥n

| M√©trica | Con Cryptominer | Post-Remediaci√≥n |
|---------|-----------------|------------------|
| RAM 3t-app | 2.4 GB | 53 MB |
| CPU 3t-app | 357% | 0% |
| RAM disponible | 636 MB | 2.9 GB |

---

## üõ°Ô∏è Lecciones Aprendidas

### Lo que funcion√≥
- ‚úÖ Container Alpine m√≠nimo (sin bash/curl)
- ‚úÖ Usuario no-root en container
- ‚úÖ Red Docker aislada

### Lo que fall√≥
- ‚ùå Dependencias desactualizadas
- ‚ùå Sin monitoreo de procesos an√≥malos

---

## üîó Referencias

- [CVE-2025-55182](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
- [Incidente Paloma](/opt/paloma/docs/incidentes/2025-12-05-rce-nextjs.md)

---

**Documentado por:** Claude AI  
**Fecha:** 2025-12-14
